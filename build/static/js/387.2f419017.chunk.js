"use strict";(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[387],{47911:function(e,t,s){s.r(t),s.d(t,{default:function(){return we}});var a=s(72791),n=s(59305),i=s(88515),l=s(4942),o=s(29439),d=s(87309),r=s(88894),c=s(89215),u=s(83746),m=s(92492),x=s(61202),h=s(36462),p=s(40008),f=s(98472),j=s(72426),v=s.n(j),g=s(67471),k=s(64946),b=s(80184);var _=function(){var e=(0,a.useState)(""),t=(0,o.Z)(e,2),s=t[0],n=t[1],i=(0,a.useState)([]),j=(0,o.Z)(i,2),_=j[0],Z=j[1],y=(0,a.useState)(!1),N=(0,o.Z)(y,2),S=N[0],w=N[1],C=(0,a.useState)(!1),D=(0,o.Z)(C,2),I=D[0],T=D[1],Y=(0,a.useState)(!1),A=(0,o.Z)(Y,2),F=A[0],E=A[1],R=(0,a.useState)(!1),M=(0,o.Z)(R,2),B=M[0],z=M[1],P=(0,a.useState)(!1),L=(0,o.Z)(P,2),O=L[0],W=L[1],U=(0,a.useState)(!1),V=(0,o.Z)(U,2),H=V[0],J=V[1],G=(0,a.useState)(!1),q=(0,o.Z)(G,2),K=q[0],Q=q[1];return(0,a.useEffect)((function(){p.Z.post("/api/tc/get-contracts",{page_index:1,page_size:1e5,search:null}).then((function(e){var t=e.data.data.data.map((function(e,t){var s;return s={key:e.id,id:e.id,customer_name:e.customer_name||e.tc_customer_id,jobsite_name:e.job_site_name,contract_type:e.type,commence_on:v()(e.start_date).format("DD-MM-YYYY"),expire_on:v()(e.end_date).format("DD-MM-YYYY")},(0,l.Z)(s,"contract_type",e.type),(0,l.Z)(s,"total_tasks",e.total_tasks||0),(0,l.Z)(s,"total_staffs",e.total_staffs||0),(0,l.Z)(s,"status",e.status||"Expired"),s}));Z(t)})).catch((function(e){console.log(e)})),(0,p.Z)({method:"post",url:"/api/tc/get-customers",data:{page_index:1,page_size:1e5,customer_id:null,search:null}}).then((function(e){e.data.success&&J(e.data.data.data),console.log("Customers data fetched"),console.log(e.data.data.data)})).catch((function(e){console.log(e)})),(0,p.Z)({method:"post",url:"/api/tc/get-customer-job-sites",data:{page_index:1,page_size:1e5,customer_id:null,search:null}}).then((function(e){e.data.success&&W(e.data.data.data),console.log("Job sites data fetched"),console.log(e.data.data.data)})).catch((function(e){console.log(e)}))}),[]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)(x.Z,{title:"Customer Tasks"}),(0,b.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,b.jsxs)("div",{className:" d-flex align-items-center justify-content-between",children:[(0,b.jsx)(u.Z,{setSearchText:n}),(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",onClick:function(){Q((function(e){return console.log("Drawer "+(e?"Closed":"Open")),!e}))},children:[(0,b.jsx)(k.Z,{className:"mr-2",component:g.k1}),"Filters"]}),(0,b.jsx)(f.CSVLink,{data:_,headers:[{label:"Contract ID",key:"id"},{label:"Customer Name",key:"customer_name"},{label:"Jobsite",key:"jobsite_name"},{label:"No of Tasks",key:"total_tasks"},{label:"Staff Assigned",key:"total_Staffs"},{label:"Status",key:"status"}],filename:"All-Quotations.csv",children:(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",children:[(0,b.jsx)("img",{className:"mr-2",src:m.Z,alt:"exportIcon"}),"Export"]})})]})})]}),(0,b.jsx)("div",{children:(0,b.jsx)(h.Z,{searchText:s,selectedCustomerFilter:S,selectedJobsiteFilter:I,selectedStatusFilter:F,selectedFilter:B})}),(0,b.jsx)("div",{children:(0,b.jsxs)(r.Z,{title:"Filter",placement:"right",onClose:function(){console.log("Closed"),Q(!1)},open:K,closable:!0,visible:K,footer:[(0,b.jsx)(d.Z,{style:{color:"#F5F5F5"},type:"primary",className:"font-weight-bold mr-2",onClick:function(){z((function(e){return!e})),Q(!1)},children:"Apply"},"submit"),(0,b.jsx)(d.Z,{style:{color:"#000B23"},onClick:function(){z((function(e){return!e})),w(!1),T(!1),E(!1),Q(!1)},className:"font-weight-bold",children:"Reset"},"cancel")],children:[(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsx)("h4",{children:"Customer"}),(0,b.jsxs)(c.Z,{showSearch:!0,placeholder:"Jobsite",value:S,onChange:function(e){w(e)},className:"w-100",children:[(0,b.jsx)(c.Z.Option,{title:"None",value:null,children:"None"},"None"),H&&H.map((function(e,t){return(0,b.jsx)(c.Z.Option,{title:e.name,value:null===e||void 0===e?void 0:e.id,children:e.name},t)}))]})]}),(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsx)("h4",{children:"Jobsite"}),(0,b.jsxs)(c.Z,{showSearch:!0,placeholder:"Jobsite",value:I,onChange:function(e){T(e)},className:"w-100",children:[(0,b.jsx)(c.Z.Option,{title:"None",value:null,children:"None"},"None"),O&&O.map((function(e,t){return(0,b.jsx)(c.Z.Option,{title:e.name,value:null===e||void 0===e?void 0:e.id,children:e.name},t)}))]})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("h4",{children:"Status"}),(0,b.jsxs)(c.Z,{showSearch:!0,placeholder:"Status",value:F,onChange:function(e){E(e)},className:"w-100",children:[(0,b.jsx)(c.Z.Option,{title:"None",value:null,children:"None"},"None"),(0,b.jsx)(c.Z.Option,{title:"Active",value:"Active",children:"Active"},"Active"),(0,b.jsx)(c.Z.Option,{title:"Expired",value:"Expired",children:"Expired"},"Expired")]})]})]})})]})},Z=s(37762),y=s(90575),N=s(38217),S=s(52720),w=s(74332),C=0,D=(new Date).toISOString().replace(/T.*$/,"");I(),I();function I(){return String(C++)}var T=s.p+"static/media/TaskManagement.f3ea012c292aab3806434a3452730fab.svg",Y=s(66871);var A=function(){var e=(0,a.useState)(!0),t=(0,o.Z)(e,2),s=t[0],n=(t[1],(0,a.useState)([])),l=(0,o.Z)(n,2),d=l[0],r=l[1],c=(0,a.useState)([]),u=(0,o.Z)(c,2),m=u[0],h=u[1],f=localStorage.getItem("token"),j=(0,a.useState)([]),v=(0,o.Z)(j,2),g=(v[0],v[1],(0,i.k6)());function k(e){var t=new Date(e),s=t.getHours().toString().padStart(2,"0"),a=t.getMinutes().toString().padStart(2,"0");return"".concat(s,":").concat(a)}var _=function(e){console.log(e),console.log(d),r(m)},C=function(e,t){return(0,p.Z)({method:"post",url:"/api/tc/get-customer-job-sites",headers:{Authorization:"Bearer ".concat(f)},data:{customer_id:e}}).then((function(e){if(console.log(e.data),e.data.success)return console.log(e.data.data.data),e.data.data.data.findIndex((function(e){return e.id===t}))})).catch((function(e){console.log(e)})),0};return(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-tasks",data:{page_size:1e5,job_site_id:null}}).then((function(e){console.log(e.data.data);var t,s=e.data.data,a=[],n=(0,Z.Z)(s);try{for(n.s();!(t=n.n()).done;){var i=t.value,l=(new Date(i.task_start_date_time).toISOString().replace(/T.*$/,""),{id:i.id,title:i.task_name,start:i.task_start_date_time,end:i.task_end_date_time,contract_id:i.tc_contract_id,cust_id:i.tc_customer_id,task_id:i.id,color:"#EAF2DD",textColor:"#0369A1",borderColor:" #97BE54",job_site_id:i.tc_customer_job_site_id,serviceType:i.service_type,images:i.users.map((function(e){return e.profile_pic}))});a.push(l)}}catch(o){n.e(o)}finally{n.f()}h(a)})).catch((function(e){console.log(e)}))}),[]),(0,a.useEffect)((function(){_()}),[m]),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Z,{icon:T,title:"Task Management / Schedule"}),(0,b.jsx)(Y.Z,{children:(0,b.jsx)(y.Z,{height:"auto",plugins:[N.Z,S.Z,w.ZP],headerToolbar:{left:"today,prev,next",center:"timeGridDay,timeGridWeek,dayGridMonth",right:"title"},initialView:"timeGridWeek",editable:!1,selectable:!0,selectMirror:!0,dayMaxEvents:!0,weekends:s,events:m,select:function(e){e.view.calendar;console.log(I()),console.log(e.startStr),console.log(e.endStr),console.log(e.allDonay)},eventContent:function(e){var t=k(e.event.start),s=k(e.event.end);return console.log(e.event.extendedProps),"timeGridWeek"===e.view.type?(0,b.jsxs)("div",{style:F,children:[e.event.title,"              ",t," - ",s,(0,b.jsxs)("div",{style:{padding:"5px"},children:[" ",e.event.extendedProps.images.map((function(e,t){return e&&(0,b.jsx)("img",{src:e,alt:"profile",style:{width:"30px",height:"30px",borderRadius:"50%"}},t)}))]})]}):"timeGridDay"===e.view.type?(0,b.jsxs)("div",{style:F,children:[e.event.title,"-   ",t," - ",s,(0,b.jsxs)("div",{style:{padding:"5px"},children:[" ",e.event.extendedProps.images.map((function(e,t){return e&&(0,b.jsx)("img",{src:e,alt:"profile",style:{width:"30px",height:"30px",borderRadius:"50%"}},t)}))]})]}):(0,b.jsxs)("div",{style:F,children:[e.event.title,"-    ",t," - ",s,(0,b.jsxs)("div",{style:{padding:"5px"},children:[" ",e.event.extendedProps.images.map((function(e,t){return e&&(0,b.jsx)("img",{src:e,alt:"profile",style:{width:"30px",height:"30px",borderRadius:"50%"}},t)}))]})]})},eventClick:function(e){console.log(e.event._def);var t=e.event._def.extendedProps;console.log(t);C(t.cust_id,t.job_site_id);var s="/app/task-management/task/job-sites-tasks/".concat(t.contract_id);g.push(s)},eventsSet:_,eventChange:function(e){console.log(e)}})})]})},F={width:"100%",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},E=s(74165),R=s(15861),M=s(67734),B=s(81838),z=s(78756),P=s(81541),L=(s(16987),s(2885)),O=s(19741),W=(s(31697),s(60346)),U=s(57520),V=s(19969);var H=function(){var e=(0,i.UO)(),t=(0,a.useState)(""),s=(0,o.Z)(t,2),n=s[0],l=s[1],h=(0,a.useState)([]),j=(0,o.Z)(h,2),_=j[0],Z=(j[1],(0,a.useState)("1")),y=(0,o.Z)(Z,2),N=y[0],S=(y[1],(0,a.useState)(["All"])),w=(0,o.Z)(S,2),C=(w[0],w[1],(0,a.useState)([])),D=(0,o.Z)(C,2),I=(D[0],D[1],(0,a.useState)([])),T=(0,o.Z)(I,2),A=(T[0],T[1],(0,a.useState)([])),F=(0,o.Z)(A,2),E=F[0],R=F[1],H=(0,a.useState)({}),J=(0,o.Z)(H,2),G=J[0],q=J[1],K=(0,a.useState)(null),Q=(0,o.Z)(K,2),X=(Q[0],Q[1],localStorage.getItem("token")),$=(0,a.useState)(!1),ee=(0,o.Z)($,2),te=ee[0],se=ee[1],ae=(0,a.useState)(!1),ne=(0,o.Z)(ae,2),ie=ne[0],le=ne[1],oe=(0,a.useState)(!1),de=(0,o.Z)(oe,2),re=de[0],ce=de[1],ue=(0,a.useState)(!1),me=(0,o.Z)(ue,2),xe=me[0],he=me[1],pe=(0,a.useState)(!1),fe=(0,o.Z)(pe,2),je=fe[0],ve=fe[1],ge=[{title:"Task ID",dataIndex:"id"},{title:"Task Name",dataIndex:"task_name"},{title:"Start Date",dataIndex:"task_start_date_time",render:function(e){return(0,b.jsx)("div",{children:new Date(e).toDateString()})}},{title:"End Date",dataIndex:"recur_until",render:function(e){return(0,b.jsx)("div",{children:new Date(e).toDateString()})}},{title:"Time",dataIndex:"",render:function(e){return(0,b.jsxs)("div",{children:[v()(null===e||void 0===e?void 0:e.task_start_date_time,"YYYY-MM-DD HH:mm:ss").format("hh:mm A")," - ",v()(null===e||void 0===e?void 0:e.task_end_date_time,"YYYY-MM-DD HH:mm:ss").format("hh:mm A")]})}},{title:"Task Type",dataIndex:"task_recurrence"},{title:"Staff Assign",dataIndex:"staffAssign",render:function(e,t){var s;return(0,b.jsx)(M.C.Group,{maxCount:2,maxPopoverTrigger:"click",size:"large",maxStyle:{color:"#f56a00",backgroundColor:"#fde3cf",cursor:"pointer"},children:null===t||void 0===t||null===(s=t.staffs)||void 0===s?void 0:s.map((function(e,t){return(0,b.jsx)(M.C,{src:null===e||void 0===e?void 0:e.profile_pic})}))})}},{title:"Status",dataIndex:"task_status",render:function(e,t){return"COMPLETED"===t.task_status?(0,b.jsx)("span",{style:{color:"#00AB6F",backgroundColor:"#EDFFF9",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Completed"}):"STARTED"===t.task_status?(0,b.jsx)("span",{style:{color:"#0077b6",backgroundColor:"#DEEFFF",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Started"}):"PENDING"===t.task_status?(0,b.jsx)("span",{style:{color:"#F0A500",backgroundColor:"#FEF3DD",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Pending"}):(0,b.jsx)("span",{style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:t.task_status})}},{title:"Action",dataIndex:"action",render:function(e,t){return(0,b.jsx)(W.Z,{record:t,onDelete:Ee,index:N,contractData:G,Id:t.id,CustomerName:G.customer_name})}}],ke=(0,a.useState)([]),be=(0,o.Z)(ke,2),_e=(be[0],be[1],(0,a.useState)(1)),Ze=(0,o.Z)(_e,2),ye=(Ze[0],Ze[1]),Ne=(0,a.useState)(0),Se=(0,o.Z)(Ne,2),we=Se[0],Ce=Se[1],De=(0,a.useState)(!1),Ie=(0,o.Z)(De,2),Te=Ie[0],Ye=Ie[1],Ae=(0,a.useState)([]),Fe=(0,o.Z)(Ae,2);Fe[0],Fe[1];var Ee=function(e,t,s){(0,p.Z)({method:"post",url:"/api/tc/delete-task",headers:{Authorization:"Bearer ".concat(X)},data:{id:e[t]}}).then((function(s){console.log(s),s.data.success&&(R((function(s){return s.filter((function(s){return s[t]!==e[t]}))})),Ye(!0),setTimeout((function(){Ye(!1)}),3e3))})).catch((function(e){console.log(e)}))},Re=function(){(0,p.Z)({method:"post",url:"/api/tc/get-contract",headers:{Authorization:"Bearer ".concat(X)},data:{id:e.id,search_task:n,task_staff_assigned:[te],task_type:[ie]}}).then((function(e){console.log(e.data),e.data.success&&(q(e.data.data),R(e.data.data.tasks))})).catch((function(e){console.log(e)}))};return B.Z,B.Z.Item,B.Z.SubMenu,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.SubMenu,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,B.Z.Item,(0,a.useEffect)((function(){Re(),(0,p.Z)({method:"post",url:"/api/tc/get-users",headers:{Authorization:"Bearer ".concat(X)}}).then((function(e){console.log(e.data),e.data.success&&he(e.data.data)})).catch((function(e){console.log(e)}))}),[]),(0,a.useEffect)((function(){Re()}),[n]),(0,a.useEffect)((function(){Re()}),[re]),(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)(x.Z,{title:"Tasks List"}),(0,b.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,b.jsxs)("div",{className:" d-flex align-items-center justify-content-between",children:[(0,b.jsx)(u.Z,{setSearchText:l}),(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",onClick:function(){ve((function(e){return console.log("Drawer "+(e?"Closed":"Open")),!e}))},children:[(0,b.jsx)(k.Z,{className:"mr-2",component:g.k1}),"Filters"]}),(0,b.jsx)(f.CSVLink,{data:_,headers:[{label:"Contract ID",key:"id"},{label:"Customer Name",key:"customer_name"},{label:"Jobsite",key:"jobsite_name"},{label:"No of Tasks",key:"total_tasks"},{label:"Staff Assigned",key:"total_Staffs"},{label:"Status",key:"status"}],filename:"All-Quotations.csv",children:(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",children:[(0,b.jsx)("img",{className:"mr-2",src:m.Z,alt:"exportIcon"}),"Export"]})}),(0,b.jsx)(O.rU,{to:"/app/task-management/add-task/".concat(G.tc_customer_id,"/").concat(G.tc_customer_job_site_id,"/").concat(G.id),children:(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",type:"primary",children:[(0,b.jsx)("img",{className:"mr-2",src:L.Z,alt:"plusIcon"}),"Add New Tasks"]})})]})})]}),(0,b.jsx)(Y.Z,{children:(0,b.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,b.jsx)("div",{style:{width:"50px",height:"50px",borderRadius:"100%"},children:(0,b.jsx)("img",{src:G.customer_image,style:{borderRadius:"100%",height:"100%",width:"100%",objectFit:"cover"}})}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:[(0,b.jsx)("div",{children:(0,b.jsxs)("div",{style:{color:"#5772FF",fontSize:"14px"},children:[G.customer_name,G.status&&("ACTIVE"===G.status.toUpperCase()?(0,b.jsx)("span",{className:"ml-2",style:{color:"#00AB6F",backgroundColor:"#EDFFF9",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Active"}):"EXPIRED"===G.status.toUpperCase()?(0,b.jsx)("span",{className:"ml-2",style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:G.status}):(0,b.jsx)("span",{className:"ml-2",style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Inactive"}))]})}),(0,b.jsx)("div",{children:(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{style:{fontWeight:"bold"},children:"Jobsite:  "}),G.job_site_name," "]})}),(0,b.jsxs)("div",{children:[G.type," | ",v()(G.created_at).format("DD-MM-YYYY")]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"30px"},children:[(0,b.jsxs)("div",{children:["Date of Commencement ",(0,b.jsx)("span",{style:{fontWeight:"bold"},children:v()(G.start_date).format("DD-MM-YYYY")})]}),(0,b.jsxs)("div",{children:["Date of Expire ",(0,b.jsx)("span",{style:{fontWeight:"bold"},children:v()(G.end_date).format("DD-MM-YYYY")})]})]})]})]})}),(0,b.jsx)(z.Z,{scroll:{x:1350},columns:ge,dataSource:E,onChange:function(e){we<=e.current&&(ye(e.current),Ce(e.current))}}),(0,b.jsx)(r.Z,{title:"Filter",placement:"right",onClose:function(){console.log("Closed"),ve(!1)},open:je,closable:!0,visible:je,footer:[(0,b.jsx)(d.Z,{style:{color:"#F5F5F5"},type:"primary",className:"font-weight-bold mr-2",onClick:function(){ce((function(e){return!e})),ve(!1)},children:"Apply"},"submit"),(0,b.jsx)(d.Z,{style:{color:"#000B23"},onClick:function(){ce((function(e){return!e})),se(!1),le(!1),ve(!1)},className:"font-weight-bold",children:"Reset"},"cancel")],children:(0,b.jsxs)("div",{className:"mb-2",children:[(0,b.jsx)("h4",{children:"Staff Assign"}),(0,b.jsxs)(c.Z,{showSearch:!0,placeholder:"Jobsite",value:te,onChange:function(e){se(e)},className:"w-100",children:[(0,b.jsx)(c.Z.Option,{title:"None",value:null,children:"None"},"None"),xe&&xe.map((function(e,t){return(0,b.jsx)(c.Z.Option,{title:e.name,value:null===e||void 0===e?void 0:e.id,children:e.name},t)}))]})]})}),(0,b.jsx)(P.Z,{centered:!0,visible:Te,footer:[null],onCancel:function(){Ye(!1)},children:(0,b.jsx)(V.Z,{icon:U.Ko,title:"Job site task deleted successfully!",desc:"deleted successfully"})})]})},J=s(93433),G=s(1413),q=s(29450),K=s(73332),Q=s(50419),X=s(66106),$=s(30914),ee=s(49389),te=s(13295),se=s(50881),ae=s(25581),ne=s(83832);q.Z.Title;for(var ie=function(){var e=(0,i.UO)(),t=(0,i.TH)(),s=K.Z.useForm(),n=(0,o.Z)(s,1)[0],l=(0,a.useState)(!1),r=(0,o.Z)(l,2),u=r[0],m=r[1],h=(0,a.useState)([]),f=(0,o.Z)(h,2),v=f[0],g=f[1],_=(0,a.useState)(!1),Z=(0,o.Z)(_,2),y=Z[0],N=Z[1],S=(0,a.useState)([]),w=(0,o.Z)(S,2),C=w[0],D=w[1],I=(0,a.useState)(!1),A=(0,o.Z)(I,2),F=A[0],M=A[1],B=(0,a.useState)(!1),L=(0,o.Z)(B,2),O=L[0],W=L[1],H=(0,a.useState)({}),q=(0,o.Z)(H,2),ie=(q[0],q[1],localStorage.getItem("token"));function le(e){var t=j().format("YYYY-MM-DD");return e&&e<j(t,"YYYY-MM-DD")}var oe=(0,a.useState)({}),de=(0,o.Z)(oe,2),re=de[0],ce=de[1],ue=(0,a.useState)([]),me=(0,o.Z)(ue,2),xe=me[0],he=me[1],pe=(0,a.useState)([]),fe=(0,o.Z)(pe,2),je=(fe[0],fe[1],(0,a.useState)("")),ve=(0,o.Z)(je,2),ge=(ve[0],ve[1],(0,i.k6)()),ke=(0,a.useState)(!1),be=(0,o.Z)(ke,2),_e=(be[0],be[1],(0,a.useState)("")),Ze=(0,o.Z)(_e,2),ye=(Ze[0],Ze[1],(0,a.useState)("")),Ne=(0,o.Z)(ye,2),Se=(Ne[0],Ne[1],function(){var e=(0,R.Z)((0,E.Z)().mark((function e(){var t,s,a;return(0,E.Z)().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=[],s=0;case 2:if(!(s<xe.length)){e.next=13;break}if(a=new FormData,!xe[s].url){e.next=7;break}return t.push({url:xe[s].url}),e.abrupt("continue",10);case 7:return a.append("file",xe[s].originFileObj),e.next=10,(0,p.Z)({method:"post",url:"/api/tc/upload-document",data:a,headers:{"content-type":"multipart/form-data",Authorization:"Bearer ".concat(ie)}}).then((function(e){return console.log(e),!!e.data.success&&(console.log("response",e.data.url),t.push({url:e.data.url}),!0)})).catch((function(e){return console.log(e),!1}));case 10:s++,e.next=2;break;case 13:return e.abrupt("return",t);case 14:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()),we=function(){var t=(0,R.Z)((0,E.Z)().mark((function t(){var s,a,i;return(0,E.Z)().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(s=n.getFieldsValue(),0!==Oe.length){t.next=4;break}return Q.ZP.error("Please add checklist item"),t.abrupt("return");case 4:return t.next=6,Se();case 6:a=t.sent,i=(0,G.Z)({},s),function(t){u?lt(i,t,"".concat(p.Z.defaults.baseURL,"/api/tc/update-task"),e.taskId):lt(i,t,"".concat(p.Z.defaults.baseURL,"/api/tc/new-task"),!1)}(a);case 10:case"end":return t.stop()}}),t)})));return function(){return t.apply(this,arguments)}}(),Ce=(0,a.useState)([]),De=(0,o.Z)(Ce,2),Ie=De[0],Te=De[1],Ye=(0,a.useState)([]),Ae=(0,o.Z)(Ye,2),Fe=Ae[0],Ee=Ae[1],Re=(0,a.useState)(""),Me=(0,o.Z)(Re,2),Be=Me[0],ze=Me[1],Pe=(0,a.useState)([]),Le=(0,o.Z)(Pe,2),Oe=Le[0],We=Le[1],Ue=(0,a.useState)(""),Ve=(0,o.Z)(Ue,2),He=Ve[0],Je=Ve[1],Ge=(0,a.useState)(""),qe=(0,o.Z)(Ge,2),Ke=qe[0],Qe=qe[1],Xe=(0,a.useState)([]),$e=(0,o.Z)(Xe,2),et=$e[0],tt=$e[1],st=(0,a.useState)(""),at=(0,o.Z)(st,2),nt=at[0],it=at[1],lt=function(t,s,a,n){t.tc_customer_id=null===e||void 0===e?void 0:e.customerId,t.tc_customer_job_site_id=null===e||void 0===e?void 0:e.jobSiteId,t.tc_contract_id=null===e||void 0===e?void 0:e.contractId,t.name=t.task_name,t.description=t.task_description,t.task_category_id=Fe,t.user_ids=Ie,t.task_start_date_time=j(He).format("YYYY-MM-DD HH:mm:ss"),t.task_end_date_time=j(Ke).format("YYYY-MM-DD HH:mm:ss"),t.task_recurrence=t.task_recurrence,t.recur_forever=F?1:0,t.recur_until="".concat(nt),t.skip_weekends=O?1:0,t.check_list=Oe,t.images=s,t.task_status=Be||"PENDING",n&&(t.id=n),console.log(t),console.log(a),(0,p.Z)({method:"post",url:a,data:t,headers:{Authorization:"Bearer ".concat(ie)}}).then((function(t){console.log(t),t.data.success&&(N(!0),ce(n?{msg:"Task Updated Successfully!",desc:"Task updated."}:{msg:"Task Added Successfully!",desc:"".concat(t.data.total_tasks," tasks added in job site ").concat(e.jobSiteCount)}),setTimeout((function(){N(!1),ge.push("/app/task-management/task/job-sites-tasks/".concat(null===e||void 0===e?void 0:e.contractId))}),3e3))})).catch((function(e){Q.ZP.error(e.response.data.message)}))},ot=(0,a.useState)([]),dt=(0,o.Z)(ot,2),rt=(dt[0],dt[1],function(){(0,p.Z)({method:"post",url:"/api/tc/get-task",headers:{Authorization:"Bearer ".concat(ie)},data:{id:null===e||void 0===e?void 0:e.taskId}}).then((function(e){if(console.log(e.data),e.data.success){var t=e.data.data;n.setFieldsValue({id:t.id,task_name:t.task_name,service_type:t.service_type,task_description:t.task_description,user_ids:null===t||void 0===t?void 0:t.users.map((function(e){return e.id})),timeLine1:j("".concat(t.task_start_date_time)),timeLine2:j("".concat(t.task_end_date_time)),task_recurrence:t.task_recurrence.toUpperCase(),recur_forever:1==t.recur_forever,skip_weekends:Boolean(1==t.skip_weekends),endTaskDate:j("".concat(t.recur_until)),uploadImage:t.images,task_category:t.task_category_id}),Te(null===t||void 0===t?void 0:t.users.map((function(e){return e.id}))),ze(t.task_status),M(1==t.recur_forever),W(1==t.skip_weekends),he(t.images),Je(t.task_start_date_time),Qe(t.task_end_date_time),it(t.recur_until.slice(0,10)),We(t.check_list),Ee(t.task_category_id)}})).catch((function(e){Q.ZP.error(e.response.data.message)}))}),ct=[{title:"Contract ID",dataIndex:"id"},{title:"Customer Name",dataIndex:"customer_name"},{title:"Jobsite",dataIndex:"job_site_name"},{title:"Contract Start Date",dataIndex:"start_date",render:function(e,t){return j(t.start_date).format("DD-MM-YYYY")}},{title:"Contract End Date",dataIndex:"expire_on",render:function(e,t){return j(t.end_date).format("DD-MM-YYYY")}},{title:"Status",dataIndex:"status",render:function(e,t){return"ACTIVE"===t.status?(0,b.jsx)("span",{style:{color:"#00AB6F",backgroundColor:"#EDFFF9",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Active"}):(0,b.jsx)("span",{style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Expired"})}}];return(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-contract",headers:{Authorization:"Bearer ".concat(ie)},data:{id:e.contractId}}).then((function(e){console.log(e.data),e.data.success&&g([e.data.data])})).catch((function(e){console.log(e)})),(0,p.Z)({method:"post",url:"/api/tc/get-users",headers:{Authorization:"Bearer ".concat(ie)}}).then((function(e){console.log(e.data),e.data.success&&(tt(e.data.data),t.pathname.includes("add-task")||rt())})).catch((function(e){console.log(e)})),(0,p.Z)({method:"post",url:"/api/tc/get-task-categories",data:{}}).then((function(e){if(console.log(e.data.data),e.data.success){var t=e.data.data.map((function(e,t){return{id:e.id,category_title:e.title}}));D(t),console.log(t)}})).catch((function(e){console.log(e)})),t.pathname.includes("add-task")?m(!1):m(!0)}),[]),(0,b.jsx)(b.Fragment,{children:(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Z,{icon:T,title:"Create New Tasks"}),(0,b.jsx)(Y.Z,{children:(0,b.jsx)(z.Z,{columns:ct,dataSource:v,pagination:!1})}),(0,b.jsxs)(K.Z,{labelCol:{span:10},form:n,layout:"vertical",onFinish:we,children:[(0,b.jsxs)(X.Z,{gutter:20,children:[(0,b.jsx)($.Z,{className:"mt-3",span:17,children:(0,b.jsxs)(Y.Z,{children:[(0,b.jsx)("p",{className:"font-weight-bold text-size-md mb-4",children:"Task Details"}),u&&(0,b.jsx)(K.Z.Item,{name:"id",label:"Task ID",children:(0,b.jsx)(ee.Z,{defaultValue:"1234",disabled:!0})}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Please enter task name"}],name:"task_name",label:"Task Name",children:(0,b.jsx)(ee.Z,{})}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Please enter task description"}],name:"task_description",label:"Task Description",children:(0,b.jsx)(ee.Z.TextArea,{rows:6})})]})}),(0,b.jsxs)($.Z,{className:"mt-3 d-flex flex-column ",span:7,children:[(0,b.jsx)(X.Z,{style:{flex:"1"},className:"",children:(0,b.jsxs)(Y.Z,{className:" w-100",children:[(0,b.jsx)("p",{className:"font-weight-bold text-size-md mb-4",children:"Task Category"}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Plese select Task Category"}],className:"font-weight-bold text-size-md mb-4",name:"task_category",children:(0,b.jsx)(c.Z,{showSearch:!0,mode:"single",placeholder:"Task Category",optionFilterProp:"children",value:Fe,onChange:Ee,children:C.map((function(e,t){return(0,b.jsx)(c.Z.Option,{value:null===e||void 0===e?void 0:e.id,children:e.category_title})}))})})]})}),(0,b.jsx)(X.Z,{style:{flex:"1"},className:"",children:(0,b.jsxs)(Y.Z,{className:" w-100",children:[(0,b.jsx)("p",{className:"font-weight-bold text-size-md mb-4",children:"Assign Staff"}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Plese assign task"}],className:"font-weight-bold text-size-md mb-4",name:"user_ids",children:(0,b.jsx)(c.Z,{showSearch:!0,mode:"multiple",placeholder:"Assign Task to",optionFilterProp:"children",filterOption:function(e,t){var s,a;return null===(s=(null!==(a=null===t||void 0===t?void 0:t.title)&&void 0!==a?a:"").toString().toLowerCase())||void 0===s?void 0:s.includes(null===e||void 0===e?void 0:e.toLowerCase())},filterSort:function(e,t){var s,a;return(null!==(s=null===e||void 0===e?void 0:e.label)&&void 0!==s?s:"").toString().toLowerCase().localeCompare((null!==(a=null===t||void 0===t?void 0:t.label)&&void 0!==a?a:"").toString().toLowerCase())},value:Ie,onChange:Te,children:et.map((function(e,t){return(0,b.jsx)(c.Z.Option,{title:e.name,value:null===e||void 0===e?void 0:e.id,children:e.name},t)}))})})]})})]})]}),(0,b.jsxs)(X.Z,{gutter:20,children:[(0,b.jsx)($.Z,{span:17,children:(0,b.jsxs)(Y.Z,{className:"pr-5 pb-3",children:[(0,b.jsx)("p",{className:"font-weight-bold text-size-md mb-4",children:"Check List"}),Oe.map((function(e,t){return(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)("p",{className:"font-weight-normal",children:e.text}),(0,b.jsx)(k.Z,{onClick:function(){!function(e){var t=Oe.filter((function(t){return t.id!==e}));We(t)}(e.id)},component:ne.vo})]},t)})),(0,b.jsx)(K.Z.Item,{name:"checklistItem",children:(0,b.jsx)(ee.Z,{onPressEnter:function(e){return function(e){""!==e.target.value?(We([].concat((0,J.Z)(Oe),[{text:e.target.value,id:Oe.length+1}])),n.setFieldsValue((0,G.Z)((0,G.Z)({},n.getFieldsValue()),{},{checklistItem:""}))):Q.ZP.error("Please enter checklist item")}(e)},placeholder:"Type here"})})]})}),(0,b.jsx)($.Z,{span:7,children:(0,b.jsxs)(Y.Z,{children:[(0,b.jsx)("p",{className:"font-weight-bold text-size-md mb-4",children:"Task Timeline"}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Please select time duration"}],name:"timeLine1",children:(0,b.jsx)(te.Z,{placeholder:"select start date and time",onChange:function(e,t){console.log(e),console.log(t),Je(e)},showTime:{format:"HH:mm A"},format:"YYYY-MM-DD HH:mm A",disabledDate:le})}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Please select time duration"}],name:"timeLine2",children:(0,b.jsx)(te.Z,{placeholder:"select end date and time",onChange:function(e,t){console.log(e),console.log(t),Qe(e)},showTime:{format:"HH:mm A"},format:"YYYY-MM-DD HH:mm A",disabledDate:le})}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Please select task recurrence"}],name:"task_recurrence",children:(0,b.jsxs)(se.ZP.Group,{defaultValue:"DAILY",size:"small",style:{marginTop:16,gap:"10px",display:"flex",flexWrap:"wrap"},buttonStyle:"solid",children:[(0,b.jsx)(se.ZP.Button,{className:"taskTimeLineRadioTabs",defaultChecked:!0,value:"DAILY",children:"Daily"}),(0,b.jsx)(se.ZP.Button,{className:"taskTimeLineRadioTabs",value:"WEEKLY",children:"Weekly"}),(0,b.jsx)(se.ZP.Button,{className:"taskTimeLineRadioTabs",value:"MONTHLY",children:"Monthly"}),(0,b.jsx)(se.ZP.Button,{className:"taskTimeLineRadioTabs",value:"YEARLY",children:"Yearly"})]})}),(0,b.jsx)(K.Z.Item,{className:"recur_forever d-flex flex-row",rules:[{required:!1,message:"Missing area"}],children:(0,b.jsxs)("div",{className:"w-75 d-flex justify-content-between",children:[(0,b.jsx)("h5",{className:"mr-5",children:"Recur Forever"}),(0,b.jsx)(ae.Z,{checked:F,onChange:function(e){M(e)}})]})}),(0,b.jsx)(K.Z.Item,{className:"skip_weekends d-flex flex-row",rules:[{required:!1,message:"Missing area"}],children:(0,b.jsxs)("div",{className:"w-75 d-flex justify-content-between",children:[(0,b.jsx)("h5",{className:"mr-5",children:"Skip Weekends"}),(0,b.jsx)(ae.Z,{checked:O,onChange:function(e){W(e)}})]})}),(0,b.jsx)(K.Z.Item,{rules:[{required:!0,message:"Plese Select end task cycle date"}],label:"End task cycle on",name:"endTaskDate",children:(0,b.jsx)(te.Z,{onChange:function(e,t){it(t)},format:"YYYY-MM-DD"})})]})})]}),(0,b.jsxs)(K.Z.Item,{rules:[{required:!0}],className:"d-flex align-items-end justify-content-end Button",children:[(0,b.jsx)(d.Z,{onClick:function(){ge.goBack()},children:"Cancel"}),(0,b.jsx)(d.Z,{className:"ml-3",htmlType:"submit",type:"primary",children:"Save"})]})]}),(0,b.jsx)(P.Z,{centered:!0,visible:y,footer:[null],onCancel:function(){N(!1)},children:(0,b.jsx)(V.Z,{icon:U.Ko,title:re.msg,desc:re.desc})})]})})},le=s(93114),oe=[{key:1,id:"2311",submittedBy:{img:le,name:"John Smith"},submittedOn:"4 jan 2023",remarks:"Loreum ispum is dummy text.Loreum ispum is dummy text.Loreum ispum is dummy text.",status:"Blocker"}],de=2;de<9;de++)oe.push({key:de,id:"231"+de,submittedBy:{img:le,name:"Wade Warren"},submittedOn:"4 jan 2023",remarks:"Loreum ispum is dummy text.Loreum ispum is dummy text.Loreum ispum is dummy text.",status:"Completed"});var re=function(e){var t=e.taskId,s=e.searchText,n=(0,a.useState)([]),i=(0,o.Z)(n,2),l=i[0],d=i[1],r=[{title:"ID",dataIndex:"id",filteredValue:[s],onFilter:function(e,t){return String(t.id).toLowerCase().includes(e.toLowerCase())||String(t.submittedBy).toLowerCase().includes(e.toLowerCase())||String(t.submittedOn).toLowerCase().includes(e.toLowerCase())||String(t.report).toLowerCase().includes(e.toLowerCase())||String(t.status).toLowerCase().includes(e.toLowerCase())}},{title:"Submitted By",width:180,render:function(e){return(0,b.jsxs)("div",{className:"d-flex align-items-center",children:[(0,b.jsx)(M.C,{src:e.submitted_by_image}),(0,b.jsx)("p",{className:"m-0 p-0 ml-3 ",children:null===e||void 0===e?void 0:e.submitted_by_name})]})}},{title:"Submitted On",width:140,render:function(e){return(0,b.jsx)("div",{className:"d-flex align-items-center",children:v()(new Date(null===e||void 0===e?void 0:e.updated_at)).format("dddd, DD MMM YYYY")})}},{title:"Remarks",dataIndex:"report"},{title:"Status",dataIndex:"status"},{title:"Action",dataIndex:"action",render:function(e,t){return(0,b.jsxs)(O.rU,{to:"/app/task-management/task/task-completion-report/".concat(t.id),children:[(0,b.jsx)(k.Z,{component:ne.YA})," "]})}}],c=(0,a.useState)([]),u=(0,o.Z)(c,2),m=u[0],x=u[1],h={selectedRowKeys:m,onChange:function(e){console.log("selectedRowKeys changed: ",e),x(e)}},f=localStorage.getItem("token");return(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-task-reports",headers:{Authorization:"Bearer ".concat(f)},data:{task_id:t,statuses:["COMPLETED"]}}).then((function(e){console.log(e.data),e.data.success&&d(e.data.data.data)})).catch((function(e){console.log(e)}))}),[]),(0,b.jsx)(z.Z,{rowSelection:h,columns:r,dataSource:l})};var ce=function(){var e,t,s,n,l,r,c,h,f,j,v=(0,i.UO)(),g=(0,i.k6)(),k=localStorage.getItem("token"),_=(0,a.useState)(""),Z=(0,o.Z)(_,2),y=Z[0],N=Z[1],S=(0,a.useState)([]),w=(0,o.Z)(S,2),C=w[0],D=w[1];return(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-task",headers:{Authorization:"Bearer ".concat(k)},data:{id:v.id}}).then((function(e){console.log(e.data),e.data.success&&D(e.data.data)})).catch((function(e){console.log(e)}))}),[]),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Z,{icon:T,title:"Task Management / Job Sites Tasks / Job Completion Reports "}),(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-weight-bolder text-size-md text-primary",children:"Tasks"}),(0,b.jsx)("p",{className:"text-size-md",children:null===C||void 0===C?void 0:C.task_name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-weight-bolder text-size-md text-primary",children:"Customer"}),(0,b.jsx)("p",{className:"text-size-md",children:null===C||void 0===C||null===(e=C.customer)||void 0===e?void 0:e.name})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-weight-bolder text-size-md text-primary",children:"Job Site"}),(0,b.jsx)("p",{className:"text-size-md",children:"".concat(null!==(null===C||void 0===C||null===(t=C.job_site)||void 0===t?void 0:t.street_number)?null===C||void 0===C||null===(s=C.job_site)||void 0===s?void 0:s.street_number:""," ").concat(null!==(null===C||void 0===C||null===(n=C.job_site)||void 0===n?void 0:n.block_number)?null===C||void 0===C||null===(l=C.job_site)||void 0===l?void 0:l.block_number:""," ").concat(null!==(null===C||void 0===C||null===(r=C.job_site)||void 0===r?void 0:r.postal_code)?null===C||void 0===C||null===(c=C.job_site)||void 0===c?void 0:c.postal_code:""," ").concat(null!==(null===C||void 0===C||null===(h=C.job_site)||void 0===h?void 0:h.country)?null===C||void 0===C||null===(f=C.job_site)||void 0===f?void 0:f.country:"")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-weight-bolder text-size-md text-primary",children:"Task Type"}),(0,b.jsx)("p",{className:"text-size-md",children:"Recurring ".concat(null===C||void 0===C?void 0:C.task_recurrence,"-Repeat")})]}),(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"font-weight-bolder text-size-md text-primary",children:"Staff Assigned"}),(0,b.jsx)(M.C.Group,{maxCount:2,maxPopoverTrigger:"click",size:"small",maxStyle:{color:"#f56a00",backgroundColor:"#fde3cf",cursor:"pointer"},children:null===C||void 0===C||null===(j=C.users)||void 0===j?void 0:j.map((function(e,t){return(0,b.jsx)(M.C,{size:"small",src:null===e||void 0===e?void 0:e.profile_pic})}))})]})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-between mt-3 mb-3",children:[(0,b.jsxs)("div",{className:" d-flex align-items-center justify-content-between",children:[(0,b.jsx)(u.Z,{setSearchText:N}),(0,b.jsxs)(d.Z,{className:"d-flex align-items-center ml-2",children:[(0,b.jsx)("img",{className:"mr-2",src:m.Z,alt:"exportIcon"}),"Export"]})]}),(0,b.jsx)("div",{children:(0,b.jsx)(d.Z,{onClick:g.goBack,className:"d-flex align-items-center",size:"middle",children:"Back"})})]}),(0,b.jsx)("div",{children:(0,b.jsx)(re,{searchText:y,taskId:v.id})})]})},ue=s(73255);s.p,s.p,s.p,s.p;var me=function(){var e,t,s,n=(0,i.UO)(),l=localStorage.getItem("token"),r=(0,i.k6)(),c=(0,a.useState)({}),u=(0,o.Z)(c,2),m=u[0],h=u[1],f=(0,a.useState)([]),j=(0,o.Z)(f,2),_=j[0],Z=j[1],y=(0,a.useState)(!1),N=(0,o.Z)(y,2),S=N[0],w=N[1],C=K.Z.useForm(),D=(0,o.Z)(C,1)[0],I=function(){(0,p.Z)({method:"post",url:"/api/tc/get-task-report",headers:{Authorization:"Bearer ".concat(l)},data:{id:n.id}}).then((function(e){var t,s;(console.log(e.data),e.data.success)&&(h(e.data.data),s=null===(t=e.data.data)||void 0===t?void 0:t.tc_job_site_task_id,(0,p.Z)({method:"post",url:"/api/tc/get-task",headers:{Authorization:"Bearer ".concat(l)},data:{id:s}}).then((function(e){console.log(e.data),e.data.success&&Z(e.data.data)})).catch((function(e){console.log(e)})),console.log(v()(null===m||void 0===m?void 0:m.updated_at).format("DD-MM-YYYY")))})).catch((function(e){console.log(e)}))};return(0,a.useEffect)((function(){I()}),[]),console.log(null===m||void 0===m?void 0:m.before_images),(0,b.jsxs)("div",{children:[(0,b.jsx)(x.Z,{icon:T,title:"Task Management / Job Sites Tasks / Job Completion Reports "}),(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("p",{className:"font-weight-bolder font-size-md",children:[(0,b.jsx)(k.Z,{component:ne.YA}),"  Task Completion Report"]})}),(0,b.jsxs)(K.Z,{style:{gap:"10px"},className:"d-flex",form:D,children:[(0,b.jsx)(K.Z.Item,{children:(0,b.jsx)(O.rU,{children:(0,b.jsx)(d.Z,{onClick:r.goBack,className:"px-5",size:"middle",children:"Back"})})}),(0,b.jsx)(K.Z.Item,{children:(0,b.jsx)(te.Z,{format:"dddd, DD MMM YYYY",value:v()(null===m||void 0===m?void 0:m.updated_at),inputReadOnly:!0,allowClear:!1})})]})]}),(0,b.jsxs)(Y.Z,{children:[(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Report ID"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===m||void 0===m?void 0:m.id})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task ID"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===m||void 0===m?void 0:m.tc_job_site_task_id})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task Date"}),(0,b.jsx)("p",{className:"font-weight-normal",children:new Date(null===_||void 0===_?void 0:_.task_start_date_time).toDateString()})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Services"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===_||void 0===_?void 0:_.service_type})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task Description"}),(0,b.jsx)("p",{style:{maxWidth:"780px"},className:"font-weight-normal",children:null===_||void 0===_?void 0:_.task_description})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Check List"}),(0,b.jsx)("div",{children:null===m||void 0===m||null===(e=m.check_list)||void 0===e?void 0:e.map((function(e,t){return(0,b.jsxs)("p",{className:"font-weight-normal",children:[(0,b.jsx)(k.Z,{component:g.m9}),null===e||void 0===e?void 0:e.text]})}))})]}),(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Service Before Pictures/Videos"}),(0,b.jsx)("div",{className:"d-flex justify-content-between mt-4 mb-2",children:null===m||void 0===m||null===(t=m.before_images)||void 0===t?void 0:t.map((function(e,t){return(0,b.jsx)("img",{style:{width:"23%"},className:"",src:e.url,alt:""})}))})]}),(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Service After Pictures/Videos"}),(0,b.jsx)("div",{className:"d-flex justify-content-between mt-4 mb-2",children:null===m||void 0===m||null===(s=m.after_images)||void 0===s?void 0:s.map((function(e,t){return(0,b.jsx)("img",{style:{width:"23%"},className:"",src:e.url,alt:""})}))})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Remarks by Staff"}),(0,b.jsx)("p",{style:{maxWidth:"780px"},className:"font-weight-normal",children:null===m||void 0===m?void 0:m.report})]})]}),(0,b.jsxs)("div",{className:"d-flex align-items-end justify-content-end mt-2 Button",children:[(0,b.jsx)(d.Z,{onClick:r.goBack,className:"px-5",children:"Back"}),(0,b.jsx)(d.Z,{icon:(0,b.jsx)(ue.p5,{}),className:"ml-2 text-center d-flex align-items-center",type:"primary",htmlType:"submit",onClick:function(){var e="";e=window.location.hostname.includes("local")?"".concat(p.Z.defaults.baseURL):window.location.protocol+"//"+window.location.hostname,w(!0);var t={url:e+"/task-completion-report-print/"+n.id,"no-download":!0,folder_name:"task-reports"};(0,p.Z)({method:"post",url:"/api/tc/download-task-report",headers:{Authorization:"Bearer ".concat(l)},data:t}).then((function(e){console.log(e.data),w(!1),e.data.success&&window.open(e.data.url,"_blank")})).catch((function(e){console.log(e),w(!1)}))},loading:S,children:" Download"})]})]})};var xe=function(){var e,t,s,n,l,r,c,u,m,h,f=(0,i.UO)(),j=(0,i.k6)(),_=(localStorage.getItem("token"),(0,a.useState)([])),Z=(0,o.Z)(_,2),y=Z[0],N=Z[1],S=(0,i.TH)().search,w=new URLSearchParams(S).get("isScheduleView");return(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-task",data:{id:+f.jobSiteTaskId}}).then((function(e){console.log(e.data),e.data.success&&N(e.data.data)})).catch((function(e){console.log(e)}))}),[]),(0,b.jsxs)("div",{style:{backgroundColor:"#F5F7FB"},children:[(0,b.jsxs)("div",{style:{backgroundColor:"#FFFFFF",margin:"-25px",background:"#ffffff",padding:"25px",paddingBottom:"0px",marginBottom:"25px"},children:[(0,b.jsx)(x.Z,{icon:T,title:"Task Management / Job Sites Tasks / Task Details "}),(0,b.jsxs)("div",{className:"d-flex justify-content-between pb-4",children:[(0,b.jsx)("div",{children:(0,b.jsxs)("p",{className:"font-weight-bolder font-size-md",children:[(0,b.jsx)(k.Z,{component:ne.YA}),"  Task Details"]})}),(0,b.jsxs)("div",{style:{gap:"10px"},className:"d-flex",children:[(0,b.jsx)(d.Z,{onClick:j.goBack,className:"px-5",size:"middle",children:"Back"}),!w&&(0,b.jsx)(O.rU,{to:"/app/task-management/task/edit/".concat(null===y||void 0===y||null===(e=y.job_site)||void 0===e?void 0:e.name,"/").concat(null===y||void 0===y||null===(t=y.customer)||void 0===t?void 0:t.name,"/").concat(null===y||void 0===y?void 0:y.tc_customer_job_site_id,"/").concat(null===y||void 0===y?void 0:y.tc_customer_id,"/").concat(null===y||void 0===y?void 0:y.id,"/").concat(f.jobSiteCount),children:(0,b.jsx)(d.Z,{className:"px-5",type:"primary",size:"middle",children:"Edit"})})]})]})]}),(0,b.jsxs)("div",{style:{backgroundColor:"#F5F7FB"},children:[(0,b.jsxs)(Y.Z,{children:[(0,b.jsxs)("div",{className:"mb-4 d-flex justify-content-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task ID"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===y||void 0===y?void 0:y.id})]}),(0,b.jsxs)("div",{className:"text-right",children:["COMPLETED"===y.task_status&&(0,b.jsx)(d.Z,{style:{backgroundColor:"#00AB6F",color:"#FFFFFF"},className:"px-4 mb-2 font-weight-semibold font-size-normal ",size:"small",children:null===y||void 0===y?void 0:y.task_status}),"PENDING"===y.task_status&&(0,b.jsx)(d.Z,{style:{backgroundColor:"#fca311",color:"#FFFFFF"},className:"px-4 mb-2 font-weight-semibold font-size-normal ",size:"small",children:null===y||void 0===y?void 0:y.task_status}),"Blocker"===y.task_status&&(0,b.jsx)(d.Z,{style:{backgroundColor:"#F53434",color:"#FFFFFF"},className:"px-4 mb-2 font-weight-semibold font-size-normal ",size:"small",children:null===y||void 0===y?void 0:y.task_status}),"COMPLETED"===y.task_status&&(0,b.jsxs)("p",{className:"font-weight- text-right",children:["Completion Date: ",v()(new Date(null===y||void 0===y?void 0:y.updated_at)).format("dddd, DD MMM YYYY")]})]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Company"}),(0,b.jsxs)("p",{className:"font-weight-normal",children:[" ",(0,b.jsx)(M.C,{src:null===y||void 0===y||null===(s=y.customer)||void 0===s?void 0:s.profile_pic,className:"mr-2"})," ",null===y||void 0===y||null===(n=y.customer)||void 0===n?void 0:n.name," "]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Job Site"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===y||void 0===y||null===(l=y.job_site)||void 0===l?void 0:l.name})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task Name"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===y||void 0===y?void 0:y.task_name})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task Description"}),(0,b.jsx)("p",{style:{maxWidth:"780px"},className:"font-weight-normal",children:null===y||void 0===y?void 0:y.task_description})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Check List"}),(0,b.jsx)("div",{children:null===y||void 0===y||null===(r=y.check_list)||void 0===r?void 0:r.map((function(e,t){return(0,b.jsxs)("p",{className:"font-weight-normal",children:[(0,b.jsx)(k.Z,{component:g.m9})," ",null===e||void 0===e?void 0:e.text]},t)}))})]}),(0,b.jsxs)("div",{className:"mb-5",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Images"}),(0,b.jsxs)("div",{className:"d-flex justify-content-start mt-4 mb-2",children:[null===y||void 0===y||null===(c=y.images)||void 0===c?void 0:c.map((function(e,t){return(0,b.jsx)("img",{style:{width:"23%"},className:"mr-2",src:null===e||void 0===e?void 0:e.url,alt:""},t)})),null===y||void 0===y||null===(u=y.before_images)||void 0===u?void 0:u.map((function(e,t){return(0,b.jsx)("img",{style:{width:"23%",height:"10%"},className:"mr-2",src:null===e||void 0===e?void 0:e.url,alt:""},t)})),null===y||void 0===y||null===(m=y.after_images)||void 0===m?void 0:m.map((function(e,t){return(0,b.jsx)("img",{style:{width:"23%",height:"10%"},className:"mr-2",src:null===e||void 0===e?void 0:e.url,alt:""},t)}))]})]})]}),(0,b.jsxs)(Y.Z,{children:[(0,b.jsx)("p",{className:"mb-4 font-size-md font-weight-bold",children:"Task Timeline"}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Task Date"}),(0,b.jsx)("p",{className:"font-weight-normal",children:new Date(null===y||void 0===y?void 0:y.task_end_date_time).toGMTString().slice(0,17)})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Time"}),(0,b.jsxs)("p",{className:"font-weight-normal",children:[v()(null===y||void 0===y?void 0:y.task_start_date_time,"HH:mm").format("hh:mm A")," - ",v()(null===y||void 0===y?void 0:y.task_end_date_time,"HH:mm").format("hh:mm A")," "]})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"Recur"}),(0,b.jsx)("p",{className:"font-weight-normal",children:null===y||void 0===y?void 0:y.task_recurrence})]}),(0,b.jsxs)("div",{className:"mb-4",children:[(0,b.jsx)("p",{className:"m-0 p-0 mb-2 font-weight-bold",children:"End Cycle Date"}),(0,b.jsx)("p",{className:"font-weight-normal",children:new Date(null===y||void 0===y?void 0:y.recur_until).toGMTString().slice(0,17)})]})]}),(0,b.jsxs)(Y.Z,{children:[(0,b.jsx)("p",{className:"mb-4 font-size-md font-weight-bold",children:"Task Assigned To"}),(0,b.jsx)("div",{style:{gap:"15px",display:"flex",flexDirection:"column"},children:null===y||void 0===y||null===(h=y.users)||void 0===h?void 0:h.map((function(e,t){return(0,b.jsx)(X.Z,{className:"d-flex align-items-center",children:(0,b.jsxs)($.Z,{span:6,className:"font-weight-normal d-flex align-items-center",children:[" ",(0,b.jsx)(M.C,{src:null===e||void 0===e?void 0:e.profile_pic})," ",(0,b.jsx)("span",{style:{color:"#5f7087"},className:"font-weight-bold ml-2",children:null===e||void 0===e?void 0:e.name})]})},t)}))})]}),"Blocker"==(null===y||void 0===y?void 0:y.task_status)&&(0,b.jsxs)(Y.Z,{children:[(0,b.jsx)("p",{className:"mb-4 font-size-md font-weight-bold",children:"Blocker Remarks"}),(0,b.jsx)("div",{className:"mb-4",children:(0,b.jsx)("p",{className:"font-weight-normal",children:null===y||void 0===y?void 0:y.task_remark})})]})]})]})},he=(s(63555),s(47528)),pe=s(87661),fe=s(32014);var je=function(){var e,t,s,n,l=(0,i.UO)(),d=(0,a.useState)({}),r=(0,o.Z)(d,2),c=r[0],u=r[1],m=(0,a.useState)([]),h=(0,o.Z)(m,2),f=h[0],j=h[1],g=localStorage.getItem("token");(0,a.useEffect)((function(){(0,p.Z)({method:"post",url:"/api/tc/get-task",headers:{Authorization:"Bearer ".concat(g)},data:{id:null===l||void 0===l?void 0:l.taskId}}).then((function(e){console.log(e.data),e.data.success&&u(e.data.data)})).catch((function(e){console.log(e)})),(0,p.Z)({method:"post",url:"/api/tc/get-task-reports",headers:{Authorization:"Bearer ".concat(g)},data:{task_id:null===l||void 0===l?void 0:l.taskId,page_index:1,page_size:1e7}}).then((function(e){e.data.success&&j(e.data.data.data)})).catch((function(e){console.log(e)}))}),[]);var _=[{title:"Report ID",dataIndex:"id"},{title:"Staff Name",dataIndex:"submitted_by_name"},{title:"Submission Date",dataIndex:"created_at",render:function(e){return v()(e).format("DD-MM-YYYY")}},{title:"Report",dataIndex:"report"},{title:"Action",dataIndex:"action",render:function(e,t){return(0,b.jsx)("div",{children:(0,b.jsx)(O.rU,{to:"/app/task-management/task/view-task-report/".concat(l.taskId,"/").concat(t.user_id),className:"d-flex align-items-center",children:(0,b.jsx)(k.Z,{className:"mr-2",component:ne.K3})})})}}];return(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsx)(x.Z,{title:" Tasks Details"}),(0,b.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,b.jsx)("div",{className:" d-flex align-items-center justify-content-between"})})]}),(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between",gap:"10px"},children:[(0,b.jsxs)(Y.Z,{style:{width:"30%",minHeight:"700px",overflowY:"auto"},children:[(0,b.jsxs)("div",{style:{display:"flex",justifyContent:"space-between"},children:[(0,b.jsx)("div",{children:"TASK OVERVIEW"}),"COMPLETED"===c.task_status?(0,b.jsx)(he.Z,{color:"success",children:"Completed"}):"STARTED"===c.task_status?(0,b.jsx)(he.Z,{color:"processing",children:"Started"}):"PENDING"===c.task_status?(0,b.jsx)(he.Z,{color:"warning",children:"Pending"}):(0,b.jsx)(he.Z,{color:"error",children:c.task_status})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"20px",marginTop:"20px"},children:[(0,b.jsxs)("div",{style:{height:"100px",width:"32%",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#297BF6"},children:[(0,b.jsx)("div",{children:f.length}),(0,b.jsx)("div",{children:"Task Reports"})]}),(0,b.jsxs)("div",{style:{height:"100px",width:"32%",color:"#fff",display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",background:"#EC9900"},children:[" ",(0,b.jsx)("div",{children:v()(c.task_end_date_time).diff(v()(),"days")}),(0,b.jsx)("div",{children:"Days Remain"})]})]}),(0,b.jsxs)("div",{style:{marginTop:"10px",width:"80%",display:"flex",justifyContent:"space-between",flexDirection:"column",gap:"10px"},children:[(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,b.jsx)("div",{children:(0,b.jsx)(k.Z,{component:ne.Nc})}),(0,b.jsxs)("div",{children:[null===(e=c.customer)||void 0===e?void 0:e.name," "]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,b.jsx)("div",{children:(0,b.jsx)(k.Z,{component:ne._t})}),(0,b.jsxs)("div",{children:[null===(t=c.job_site)||void 0===t?void 0:t.address," "]})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,b.jsx)("div",{children:(0,b.jsx)(k.Z,{component:ne.V7})}),(0,b.jsx)("div",{children:c.task_name})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px",alignItems:"center"},children:[(0,b.jsx)("div",{children:(0,b.jsx)(k.Z,{component:ne.P$})}),(0,b.jsx)("div",{children:c.task_description})]}),(0,b.jsxs)("div",{style:{display:"flex",gap:"10px"},children:[(0,b.jsx)("div",{children:(0,b.jsx)(k.Z,{component:ne.V7})}),(0,b.jsxs)("div",{children:[(0,b.jsx)("div",{children:"Staff Assigned"}),null===(s=c.users)||void 0===s?void 0:s.map((function(e,t){return(0,b.jsx)("div",{style:{fontWeight:"bold",marginTop:"5px"},children:e.name},t)}))]})]})]})]}),(0,b.jsx)(Y.Z,{style:{width:"70%"},children:(0,b.jsxs)(pe.Z,{children:[(0,b.jsxs)(pe.Z.TabPane,{tab:"Task Details",children:[(0,b.jsx)(Y.Z,{title:"Checklist",style:{minHeight:"300px",overflowY:"auto"},children:(0,b.jsx)("div",{style:{display:"flex",gap:"10px",flexDirection:"column"},children:null===(n=c.check_list)||void 0===n?void 0:n.map((function(e,t){return(0,b.jsxs)("div",{style:{background:"#FBFBFB",padding:"10px"},children:[(0,b.jsx)(fe.Z,{disabled:!0,style:{marginRight:"10px"}}),e.text]},t)}))})}),(0,b.jsx)(Y.Z,{title:"Task TIMELINE",style:{minHeight:"300px",overflowY:"auto"},children:(0,b.jsxs)("div",{style:{display:"flex",gap:"100px",flexDirection:"row"},children:[(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,b.jsx)("div",{children:"Task Type"}),(0,b.jsx)("div",{children:"Start Date"}),(0,b.jsx)("div",{children:"End Date"}),(0,b.jsx)("div",{children:"Task Time"}),(0,b.jsx)("div",{children:"Recur Forever"}),(0,b.jsx)("div",{children:"Skip Weekends"})]}),(0,b.jsxs)("div",{style:{display:"flex",flexDirection:"column",gap:"10px"},children:[(0,b.jsx)("div",{children:"Need to check"}),(0,b.jsx)("div",{children:c.task_start_date_time&&v()(c.task_start_date_time).format("DD-MM-YYYY")}),(0,b.jsx)("div",{children:c.task_end_date_time&&v()(c.task_end_date_time).format("DD-MM-YYYY")}),(0,b.jsxs)("div",{children:[v()(c.task_start_date_time).format("HH:mm a")," -",v()(c.task_end_date_time).format("HH:mm a")]}),(0,b.jsx)("div",{children:c.recur_forever?"Yes":"No"}),(0,b.jsx)("div",{children:c.skip_weekends?"Yes":"No"})]})]})})]},"1"),(0,b.jsx)(pe.Z.TabPane,{tab:"Task Reports",children:(0,b.jsx)(z.Z,{columns:_,dataSource:f})},"2")]})})]})]})},ve=s(91333),ge={card:"TaskReport_card__qTANt","quotation-card":"TaskReport_quotation-card__vHKlD","ant-card-body":"TaskReport_ant-card-body__4VKgr",add_details:"TaskReport_add_details__jphbS",total_amt:"TaskReport_total_amt__Qul-2",tag:"TaskReport_tag__kJ6cl",send_btn:"TaskReport_send_btn__Y48kd",action:"TaskReport_action__0iNfd"},ke=s(92995),be=s(41667),_e="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACUAAAAlCAYAAADFniADAAAACXBIWXMAAAsTAAALEwEAmpwYAAAAAXNSR0IArs4c6QAAAARnQU1BAACxjwv8YQUAAAYSSURBVHgBxVdrbBRVFP7uzOzMvtgubemWlxQkKRCDVaJCYkxJJRoEDQlGE01EEpEYiZRoiCYIMZiYigoGsf6SoD8kUWNQMSE+ipGHoBaMBkiqKbak9EHLdruP2d2Z65mZ3em+u+02+iV35t577uObc8495w5DBVjV2uNSEsICCI5aHVxPyrzr9L76AVQIVkoY7USDADyV2SdXA2f+WXNX7/DiO8Nx72yjb5htgsoWmHJRYNFZ1cLFFUulc3U10jAmCY3jUklSaid2g2NPus2IoaMuf9x14SVcE9vsts8FeJ2YKsakckbpESrqeJvJ42/RDQhQMY3wCsUkLdtvrPri0jObTFJxgMesYtT1mFV4InsO5xw6lYTOEU+WX9TUO42Cmmre1v9EEtqRkOrPIq27F0Fz6AjfehSe3mch40LWvLAaRyyZxHAYkwb5IpbNcYOxAqSaXxhcxxk/wgyrZECb0YTIyjOmiuTQV5BiRMiVPdfrVODhcgGfKuK6rLAki1TLtr5lGsNHuYTMLwldgHK5FaxmIdz9L6MQVNKSmkgiSmYdGkNJzK9RILHCZG1Szbu5pAUHvybP8BdbSO5pJw2hiNENEwiQRAEKyeUJjhDnxWX2VOHm4F6doaHQIEGhRVK6Ew2TpU6f4MhZzCAly5WGBItU8/a+Bh3YmSvUuMVZMIgYhYhJNfmLaLnOVRmGzV0ZxF2FtPnl5adxI1IPkSXtPuZk4Bm+wIhpUNhAxEJ2HynMNGEJC+Vh4wOe1tpqYTSeRJe5+urWgW6y8QL8n+B4vONA3VGjKq3eMdTCdd0kND9wDC5nrz3OIXLIOX7jcjfB612T3Uc+JzJMGjGVo+N8DJEoJ+3zzdRlkeJcX29UZEcQTY2vZE2q8ui0YbYRBMGNxUv+piBn+RsdNgSqMGUkKQOfOBUjN2B323sQxdtNdqIVWHTy+JthwSwDQRFBeqeLJadEiASmC07FVrG/+fmhJSYXMubcLOZEKpqRXxVp3C4+Sr6Z8c7KdcbXptq2AHlId0kiaaJI0ISk30bPyxINri80RFGMGDqCxkVbzDvLlb/as+QaERoJR8z6YAhlw+eS0FCrFBYywWNyI1u6C33aQ/cdglP2osbfiO9Ob8iTi/S11R636VO1XpQNUZx4jGG+UXrPzBV8e2Yn1q9uNwmNBP/Im2iYLhKPm+bU9NKbeF0i/K6yrm5pUggWIjU61oPPT6yF31M8BBq+YZheKnors1B+tGD9KVK8ixoNNksBdhhwOXhWSMj0T0YNN+W5SkNCFqVEss8iJQgX6Ajdn76tGCkirR0fxSm3kqspg5kD04XRMcv2tMtox8HARZOUrmvfCBBejMRmo/PK6/A4r9kTDIJOOZuU29OEq8NGzBiPGy55ahE9EuP46bd4unkqXZF+rAp0NAcHb1Ld39v/SLnLYbpB3nDUrhuPHVt+3R1QR/bkDuQeJ0LLG6E5x+OKcaSNCxyfzBUghT+7Ehgc1vIFHP0/7J81m/zUXNU8p2/1fvIBT/IdxNGXO7531cMYePBeu11DMUmZokv1XE9i576RvH6dsffThAyY3s2Ov3k9qiYORlQV6ZLQrC8Sw1FMF5xyIcfj3bGEejCzx44w7qTyRiye6KYCoyQ1Df8JOHade2/ejcwuO8yyU22hoZXPreUC7yRF5iWnUCxGfyvahH8pmVgccFEsKx5Z6Qb72sn9dR/n9mfF/tqzhy4Nrdy6lY7Ch7kDvYpCG3BUua2rrv0xRX/pGBxSiTjB8OnJt2v34J18UV5Cqj3bfpg0Zsx6lx4z0v3GP12SLls8Yl3sTPCsl02y3i+bCbsoOP/MJ9dtRoZzZ6Kgbkljh92CTFEe3fZmmWvqqcJToSGjGO1SqZCDvdpxILDxWBsreuEpGYf5uta5V598bO9Qyz2b0n2VhARC9xyJLZxoUFnJ4eIIX5hIoI1Gb5zpsdLKVEBa/H2uw7p+V0wqjc4+3uDwoLn7qvpo/5C+PBLV5+WOkSSMVXmFrjuWKt/7fcJopiyh4fgtMjs/0T5TSKPjWLHlF4fPO38ZZ44ZDoGNjcbjfT8fCPSjQvwL78M7phtinJ8AAAAASUVORK5CYII=",Ze=q.Z.Title,ye=q.Z.Text,Ne={page:{margin:be.Zt.SMALL}};var Se=function(){var e=(0,i.k6)(),t=(0,a.useRef)(null),s=(0,a.useState)({}),n=(0,o.Z)(s,2),l=n[0],r=n[1],c=(0,a.useState)({}),u=(0,o.Z)(c,2),m=(u[0],u[1],(0,a.useState)([])),h=(0,o.Z)(m,2),f=h[0],j=h[1],g=(0,i.UO)(),_=localStorage.getItem("token"),Z=function(){(0,p.Z)({method:"post",url:"/api/tc/get-task-report-by-task-and-user-id",headers:{Authorization:"Bearer ".concat(_)},data:{task_id:null===g||void 0===g?void 0:g.taskId,user_id:null===g||void 0===g?void 0:g.userId}}).then((function(e){var t;console.log(e.data),e.data.success&&(r(e.data.data),t=e.data.data,(0,p.Z)({method:"post",url:"/api/tc/get-task",headers:{Authorization:"Bearer ".concat(_)},data:{id:null===g||void 0===g?void 0:g.taskId}}).then((function(e){if(console.log(e.data),e.data.success){var s,a,n,i,l,o,d,c,u,m,x=t.user_id;console.log(t.status),j([{key:"1",report_by:e.data.data.users.filter((function(e){return e.id===x}))[0].name,customer:null===(s=e.data.data)||void 0===s||null===(a=s.customer)||void 0===a?void 0:a.name,job_site:null===(n=e.data.data)||void 0===n||null===(i=n.job_site)||void 0===i?void 0:i.name,start_date:null!==(l=e.data.data)&&void 0!==l&&l.task_start_date_time?v()(null===(o=e.data.data)||void 0===o?void 0:o.task_start_date_time).format("DD-MM-YYYY"):"-",end_date:null!==(d=e.data.data)&&void 0!==d&&d.task_end_date_time?v()(null===(c=e.data.data)||void 0===c?void 0:c.task_end_date_time).format("DD-MM-YYYY"):"-",time:v()(null===(u=e.data.data)||void 0===u?void 0:u.task_start_date_time).format("hh:mm A")+" - "+v()(null===(m=e.data.data)||void 0===m?void 0:m.task_end_date_time).format("hh:mm A"),task_status:t.status}]),r({id:t.id,submitted_by:e.data.data.users.filter((function(e){return e.id===x}))[0].name,created_at:v()(t.created_at).format("DD-MM-YYYY"),task_name:e.data.data.task_name,remarks:t.report,before_images:t.before_images,after_images:t.after_images,check_list:t.check_list})}})).catch((function(e){console.log(e)})))})).catch((function(e){console.log(e)}))};(0,a.useEffect)((function(){Z()}),[]);var y=[{title:"Report By",dataIndex:"report_by"},{title:"Customer",dataIndex:"customer"},{title:"Jobsite",dataIndex:"job_site"},{title:"Start Date",dataIndex:"start_date"},{title:"End Date",dataIndex:"end_date"},{title:"Time",dataIndex:"time"},{title:"Status",dataIndex:"status",render:function(e,t){return"COMPLETED"===t.task_status?(0,b.jsx)("span",{style:{color:"#00AB6F",backgroundColor:"#EDFFF9",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Completed"}):"STARTED"===t.task_status?(0,b.jsx)("span",{style:{color:"#0077b6",backgroundColor:"#DEEFFF",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Started"}):"PENDING"===t.task_status?(0,b.jsx)("span",{style:{color:"#F0A500",backgroundColor:"#FEF3DD",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Pending"}):(0,b.jsx)("span",{style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:t.task_status})}}];return(0,b.jsxs)(a.Fragment,{children:[(0,b.jsx)(x.Z,{title:"Task Completion Report"}),(0,b.jsx)(Y.Z,{className:"quotation-card",children:(0,b.jsxs)("div",{ref:t,children:[(0,b.jsx)(Y.Z,{className:ge.card,children:(0,b.jsxs)("div",{className:"mt-2 mb-2 w-100",children:[(0,b.jsx)("img",{src:ke,alt:"logo",style:{width:"20%"}}),(0,b.jsxs)("div",{className:"d-flex justify-content-between mt-3",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)(Ze,{strong:!0,level:3,children:"GRAND ENERGY TECHNOLOGIES PTE LTD"}),(0,b.jsxs)(ye,{children:[(0,b.jsx)("b",{children:"Email:"})," admin@getpl.com.sg"]})]}),(0,b.jsx)("div",{})]}),(0,b.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsxs)(ye,{children:[(0,b.jsx)("b",{children:"Phone:"})," 6025 3659"]}),(0,b.jsx)("br",{}),(0,b.jsxs)(ye,{children:[(0,b.jsx)("b",{children:"UEN/GST No:"})," 201802457D"]})]}),(0,b.jsxs)("div",{className:"text-right",children:[(0,b.jsx)(ye,{children:"Bik 130 Jurong Gateway Road "}),(0,b.jsx)("br",{}),(0,b.jsx)(ye,{children:"#03-203 Singapore 600130 "})]})]})]})}),(0,b.jsxs)("div",{style:{display:"flex",gap:"20px"},children:[(0,b.jsx)("div",{children:(0,b.jsx)("img",{src:_e})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{children:["Task Completion Report - #",l.id]}),(0,b.jsxs)("div",{children:["Report Date: ",l.created_at]})]})]}),(0,b.jsx)(z.Z,{dataSource:f,columns:y,pagination:!1}),(0,b.jsxs)("div",{style:{marginTop:"50px"},children:[(0,b.jsx)(Ze,{level:4,children:"Task Details"}),(0,b.jsx)("div",{children:l.task_name})]}),(0,b.jsxs)("div",{style:{marginTop:"50px"},children:[(0,b.jsx)(Ze,{level:4,children:"Task Description"}),(0,b.jsx)("div",{children:l.remarks})]}),(0,b.jsxs)("div",{style:{marginTop:"50px"},children:[(0,b.jsx)(Ze,{level:4,children:"Checklist"}),(0,b.jsx)("div",{children:l.check_list&&l.check_list.map((function(e,t){return(0,b.jsx)("div",{children:(0,b.jsx)(fe.Z,{checked:e.isChecked,children:(0,b.jsx)("div",{style:{textDecoration:e.isChecked?"line-through":"none"},children:e.text})})},t)}))})]}),(0,b.jsxs)("div",{style:{marginTop:"50px"},children:[(0,b.jsx)(Ze,{level:4,children:"Task Before Pictures"}),(0,b.jsx)("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:l.before_images&&l.before_images.map((function(e,t){return(0,b.jsx)("div",{style:{width:"23%",height:"400px"},children:(0,b.jsx)("img",{src:e.url,alt:"task",style:{width:"100%",height:"100%",borderRadius:"10px"}})},t)}))})]}),(0,b.jsxs)("div",{style:{marginTop:"50px"},children:[(0,b.jsx)(Ze,{level:4,children:"Task After Pictures"}),(0,b.jsx)("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap"},children:l.after_images&&l.after_images.map((function(e,t){return(0,b.jsx)("div",{style:{width:"23%",height:"400px"},children:(0,b.jsx)("img",{src:e.url,alt:"task",style:{width:"100%",height:"100%",borderRadius:"10px"}})},t)}))})]}),(0,b.jsx)(ve.Z,{}),(0,b.jsx)("div",{children:"Submitted By"}),(0,b.jsx)("div",{style:{fontWeight:"bold"},children:l.submitted_by}),(0,b.jsx)("div",{children:v()().format("DD-MM-YYYY HH:mm A")})]})}),(0,b.jsxs)("div",{className:"d-flex justify-content-between ".concat(ge.action),children:[(0,b.jsx)("div",{className:"d-flex",children:(0,b.jsx)(d.Z,{className:"mr-1",onClick:function(){e.goBack()},children:"Back"})}),(0,b.jsxs)(d.Z,{onClick:function(){console.log("Downloading Quotation..."),(0,be.ZP)(t,Ne,{filename:"taskReport.pdf"})},children:[(0,b.jsx)(k.Z,{component:ue.p5}),"Download PDF"]})]})]})};var we=function(){var e=(0,i.$B)();return(0,b.jsxs)("div",{children:[(0,b.jsx)(i.AW,{path:"".concat(n.sH,"/task-management"),exact:!0,children:(0,b.jsx)(i.l_,{to:"".concat(e.path,"/task")})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/task-completion-reports/:id"),exact:!0,children:(0,b.jsx)(ce,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/task-completion-report/:id"),exact:!0,children:(0,b.jsx)(me,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task"),exact:!0,children:(0,b.jsx)(_,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/edit-task/:customerId/:jobSiteId/:contractId/:taskId"),exact:!0,children:(0,b.jsx)(ie,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/add-task/:customerId/:jobSiteId/:contractId"),exact:!0,children:(0,b.jsx)(ie,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/view-details/:customerId/:jobSiteId/:contractId/:taskId"),exact:!0,children:(0,b.jsx)(je,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/view-task-report/:taskId/:userId"),exact:!0,children:(0,b.jsx)(Se,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/job-sites-tasks/:id"),exact:!0,children:(0,b.jsx)(H,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/task/job-sites-tasks/:customerId/:jobSiteTaskId/:jobSiteCount"),exact:!0,children:(0,b.jsx)(xe,{})}),(0,b.jsx)(i.AW,{path:"".concat(e.path,"/schedule"),exact:!0,children:(0,b.jsx)(A,{})})]})}}}]);
//# sourceMappingURL=387.2f419017.chunk.js.map