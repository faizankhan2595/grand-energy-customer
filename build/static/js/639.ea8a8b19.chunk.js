(self.webpackChunkemilus=self.webpackChunkemilus||[]).push([[639],{16309:function(e,t,n){"use strict";n.r(t);var r=n(1413),o=n(4942),a=n(29439),i=n(72791),c=n(81838),s=n(81541),l=n(87309),u=n(78756),d=n(88894),f=n(89215),p=n(64946),h=n(61202),y=n(83746),v=(n(67471),n(92492)),m=n(93271),b=n(83832),g=n(40872),x=n(19741),j=n(98472),k=n(40008),w=n(72426),_=n.n(w),C=n(80184);t.default=function(){var e=(0,i.useState)(!1),t=(0,a.Z)(e,2),n=t[0],w=t[1],O=(0,i.useState)(!1),S=(0,a.Z)(O,2),Z=(S[0],S[1]),F=(0,i.useState)(!1),P=(0,a.Z)(F,2),I=P[0],N=P[1],A=(0,i.useState)(!1),R=(0,a.Z)(A,2),E=(R[0],R[1]),T=(0,i.useState)(""),D=(0,a.Z)(T,2),U=(D[0],D[1]),L=(0,i.useState)([]),M=(0,a.Z)(L,2),B=M[0],V=M[1],Y=(0,i.useState)([]),z=(0,a.Z)(Y,2),J=z[0],$=(z[1],(0,i.useState)([])),W=(0,a.Z)($,2),q=(W[0],W[1],localStorage.getItem("customer_id")),H=(0,i.useState)(!1),G=(0,a.Z)(H,2),K=G[0],Q=G[1],X=(0,i.useState)(!1),ee=(0,a.Z)(X,2),te=ee[0],ne=ee[1],re=[{title:"ID",dataIndex:"id"},{title:"Contract ID",dataIndex:"tc_contract_id"},{title:"Jobsite Name",dataIndex:"jobsite_name"},{title:"Total Tasks",dataIndex:"total_tasks"},{title:"Net Amount (S$)",dataIndex:"total"},{title:"Paid amount (S$)",dataIndex:"paid_amount",render:function(e,t){return(0,C.jsx)("div",{children:t.paid_amount||0})}},{title:"Invoice Date",dataIndex:"created_at"},{title:"Status",dataIndex:"status",render:function(e,t){return"Paid"===t.status||"PAID"===t.status?(0,C.jsx)("span",{style:{color:"#00AB6F",backgroundColor:"#EDFFF9",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Paid"}):"Overdue"===t.status||"OVERDUE"===t.status?(0,C.jsx)("span",{style:{color:"#F53434",backgroundColor:"#FFF2F2",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Overdue"}):(0,C.jsx)("span",{style:{color:"#FFC700",backgroundColor:"#FFC7001A",padding:"4px 8px",borderRadius:"6px",fontWeight:"600",fontSize:"14px"},children:"Pending"})}},{title:"Action",render:function(e,t){return(0,C.jsx)(C.Fragment,{children:(0,C.jsx)(g.Z,{menu:(0,C.jsxs)(c.Z,{children:[(0,C.jsx)(c.Z.Item,{children:(0,C.jsxs)(x.rU,{to:"/app/contract-management/quotations/view-invoice/".concat(t.id),className:"d-flex align-items-center",children:[(0,C.jsx)(p.Z,{component:m.Tx}),"View Invoice"]})}),(0,C.jsx)(c.Z.Item,{children:(0,C.jsxs)(x.rU,{to:"/app/contract-management/quotations/edit-invoice/".concat(t.id),className:"d-flex align-items-center",children:[(0,C.jsx)(p.Z,{className:"mr-2",component:b.dY}),"Edit"]})}),(0,C.jsx)(c.Z.Item,{onClick:function(){ie()},children:(0,C.jsxs)("span",{className:"d-flex align-items-center",children:[(0,C.jsx)(p.Z,{className:"mr-2",component:b.pJ}),"Delete"]})}),(0,C.jsx)(s.Z,{visible:te,centered:!0,footer:[(0,C.jsx)(l.Z,{style:{color:"#000B23"},onClick:oe,className:"font-weight-bold",children:"No, Cancel"}),(0,C.jsx)(l.Z,{type:"primary",className:"font-weight-bold",onClick:function(){return ae(t.id)},children:"Yes, Confirm"})],children:(0,C.jsx)("div",{style:{color:"#000B23"},className:"font-weight-bolder font-size-md",children:"Are Sure you want to delete this invoice?"})})]})})})}}],oe=function(){ne(!1)},ae=function(e){ce(e),ne(!1)},ie=function(){ne(!0)},ce=function(e){console.log("Invoice deleted",e),(0,k.Z)({method:"post",url:"/api/tc/delete-invoice",data:{id:e}}).then((function(t){console.log(t.data),V(B.filter((function(t){return t.id!==e})))})).then((function(e){console.log(e)}))};return(0,i.useEffect)((function(){!function(){var e;(0,k.Z)({method:"post",url:"/api/tc/get-invoices",data:(e={search:"",customer_id:n,statuses:[]},(0,o.Z)(e,"customer_id",q),(0,o.Z)(e,"page_size",1e8),(0,o.Z)(e,"page_index",1),e)}).then((function(e){console.log(e.data),e.data.success?V(e.data.data.data.map((function(e,t){return(0,r.Z)((0,r.Z)({},e),{},{index:t+1,created_at:_()(e.created_at).format("DD-MM-YYYY")})}))):console.log(e)})).then((function(e){console.log(e)}))}()}),[]),(0,C.jsxs)(i.Fragment,{children:[(0,C.jsxs)("div",{className:"d-flex justify-content-between",children:[(0,C.jsx)(h.Z,{title:"Invoices"}),(0,C.jsx)("div",{className:"d-flex justify-content-between mb-3",children:(0,C.jsxs)("div",{className:" d-flex align-items-center justify-content-between mr-2",children:[(0,C.jsx)(y.Z,{setSearchText:U}),(0,C.jsx)(j.CSVLink,{data:B,headers:[{label:"ID",key:"id"},{label:"Contract ID",key:"tc_contract_id"},{label:"Jobsite Name",key:"jobsite_name"},{label:"Total Tasks",key:"total_tasks"},{label:"Net Amount (S$)",key:"total"},{label:"Paid amount (S$)",key:"amount_paid"},{label:"Invoice Date",key:"created_at"},{label:"Status",key:"status"}],filename:"All-Invoices.csv",children:(0,C.jsxs)(l.Z,{className:"d-flex align-items-center ml-2",children:[(0,C.jsx)("img",{className:"mr-2",src:v.Z,alt:"exportIcon"}),"Export"]})})]})})]}),(0,C.jsx)("div",{children:(0,C.jsx)(u.Z,{columns:re,dataSource:B})}),(0,C.jsx)("div",{children:(0,C.jsxs)(d.Z,{title:"Filter",placement:"right",onClose:function(){console.log("Closed"),Q(!1)},open:K,closable:!0,visible:K,footer:[(0,C.jsx)(l.Z,{style:{color:"#F5F5F5"},type:"primary",className:"font-weight-bold mr-2",onClick:function(){E((function(e){return!e})),Q(!1)},children:"Apply"},"submit"),(0,C.jsx)(l.Z,{style:{color:"#000B23"},onClick:function(){E((function(e){return!e})),w(!1),Z(!1),N(!1),Q(!1)},className:"font-weight-bold",children:"Reset"},"cancel")],children:[(0,C.jsxs)("div",{className:"mb-2",children:[(0,C.jsx)("h4",{children:"Customer"}),(0,C.jsxs)(f.Z,{showSearch:!0,placeholder:"Jobsite",value:n,onChange:function(e){w(e)},className:"w-100",children:[(0,C.jsx)(f.Z.Option,{title:"None",value:null,children:"None"},"None"),J&&J.map((function(e,t){return(0,C.jsx)(f.Z.Option,{title:e.name,value:null===e||void 0===e?void 0:e.id,children:e.name},t)}))]})]}),(0,C.jsxs)("div",{children:[(0,C.jsx)("h4",{children:"Status"}),(0,C.jsxs)(f.Z,{showSearch:!0,placeholder:"Status",value:I,onChange:function(e){N(e)},className:"w-100",children:[(0,C.jsx)(f.Z.Option,{title:"None",value:null,children:"None"},"None"),(0,C.jsx)(f.Z.Option,{title:"Pending",value:"Pending",children:"Pending"},"Pending"),(0,C.jsx)(f.Z.Option,{title:"Paid",value:"Paid",children:"Paid"},"Paid"),(0,C.jsx)(f.Z.Option,{title:"Overdue",value:"Overdue",children:"Overdue"},"Overdue")]})]})]})})]})}},18111:function(e,t,n){var r=n(71848);e.exports=function(e,t){return r(e,t)}},98472:function(e,t,n){e.exports=n(23561)},98015:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),a=n(72791),i=(r=a)&&r.__esModule?r:{default:r},c=n(51509),s=n(58333);var l=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.state={},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),o(t,[{key:"buildURI",value:function(){return c.buildURI.apply(void 0,arguments)}},{key:"componentDidMount",value:function(){var e=this.props,t=e.data,n=e.headers,r=e.separator,o=e.enclosingCharacter,a=e.uFEFF,i=e.target,c=e.specs,s=e.replace;this.state.page=window.open(this.buildURI(t,a,n,r,o),i,c,s)}},{key:"getWindow",value:function(){return this.state.page}},{key:"render",value:function(){return null}}]),t}(i.default.Component);l.defaultProps=Object.assign(s.defaultProps,{target:"_blank"}),l.propTypes=s.propTypes,t.default=l},39088:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r,o=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},a=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),i=n(72791),c=(r=i)&&r.__esModule?r:{default:r},s=n(51509),l=n(58333);var u=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.buildURI=n.buildURI.bind(n),n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),a(t,[{key:"buildURI",value:function(){return s.buildURI.apply(void 0,arguments)}},{key:"handleLegacy",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]&&arguments[1];if(window.navigator.msSaveOrOpenBlob){e.preventDefault();var n=this.props,r=n.data,o=n.headers,a=n.separator,i=n.filename,c=n.enclosingCharacter,l=n.uFEFF,u=t&&"function"===typeof r?r():r,d=new Blob([l?"\ufeff":"",(0,s.toCSV)(u,o,a,c)]);return window.navigator.msSaveBlob(d,i),!1}}},{key:"handleAsyncClick",value:function(e){var t=this;this.props.onClick(e,(function(n){!1!==n?t.handleLegacy(e,!0):e.preventDefault()}))}},{key:"handleSyncClick",value:function(e){!1===this.props.onClick(e)?e.preventDefault():this.handleLegacy(e)}},{key:"handleClick",value:function(){var e=this;return function(t){if("function"===typeof e.props.onClick)return e.props.asyncOnClick?e.handleAsyncClick(t):e.handleSyncClick(t);e.handleLegacy(t)}}},{key:"render",value:function(){var e=this,t=this.props,n=t.data,r=t.headers,a=t.separator,i=t.filename,s=t.uFEFF,l=t.children,u=(t.onClick,t.asyncOnClick,t.enclosingCharacter),d=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(t,["data","headers","separator","filename","uFEFF","children","onClick","asyncOnClick","enclosingCharacter"]),f="undefined"===typeof window?"":this.buildURI(n,s,r,a,u);return c.default.createElement("a",o({download:i},d,{ref:function(t){return e.link=t},target:"_self",href:f,onClick:this.handleClick()}),l)}}]),t}(c.default.Component);u.defaultProps=l.defaultProps,u.propTypes=l.propTypes,t.default=u},51509:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function r(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}var o=t.isSafari=function(){return/^((?!chrome|android).)*safari/i.test(navigator.userAgent)},a=t.isJsons=function(e){return Array.isArray(e)&&e.every((function(e){return"object"===("undefined"===typeof e?"undefined":n(e))&&!(e instanceof Array)}))},i=t.isArrays=function(e){return Array.isArray(e)&&e.every((function(e){return Array.isArray(e)}))},c=t.jsonsHeaders=function(e){return Array.from(e.map((function(e){return Object.keys(e)})).reduce((function(e,t){return new Set([].concat(r(e),r(t)))}),[]))},s=t.jsons2arrays=function(e,t){var n=t=t||c(e),o=t;a(t)&&(n=t.map((function(e){return e.label})),o=t.map((function(e){return e.key})));var i=e.map((function(e){return o.map((function(t){return l(t,e)}))}));return[n].concat(r(i))},l=t.getHeaderValue=function(e,t){var n=e.replace(/\[([^\]]+)]/g,".$1").split(".").reduce((function(e,t,n,r){var o=e[t];if(void 0!==o&&null!==o)return o;r.splice(1)}),t);return void 0===n?e in t?t[e]:"":n},u=t.elementOrEmpty=function(e){return"undefined"===typeof e||null===e?"":e},d=t.joiner=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:",",n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:'"';return e.filter((function(e){return e})).map((function(e){return e.map((function(e){return u(e)})).map((function(e){return""+n+e+n})).join(t)})).join("\n")},f=t.arrays2csv=function(e,t,n,o){return d(t?[t].concat(r(e)):e,n,o)},p=t.jsons2csv=function(e,t,n,r){return d(s(e,t),n,r)},h=t.string2csv=function(e,t,n,r){return t?t.join(n)+"\n"+e:e.replace(/"/g,'""')},y=t.toCSV=function(e,t,n,r){if(a(e))return p(e,t,n,r);if(i(e))return f(e,t,n,r);if("string"===typeof e)return h(e,t,n);throw new TypeError('Data should be a "String", "Array of arrays" OR "Array of objects" ')};t.buildURI=function(e,t,n,r,a){var i=y(e,n,r,a),c=o()?"application/csv":"text/csv",s=new Blob([t?"\ufeff":"",i],{type:c}),l="data:"+c+";charset=utf-8,"+(t?"\ufeff":"")+i,u=window.URL||window.webkitURL;return"undefined"===typeof u.createObjectURL?l:u.createObjectURL(s)}},23561:function(e,t,n){"use strict";t.CSVLink=void 0;var r=a(n(98015)),o=a(n(39088));function a(e){return e&&e.__esModule?e:{default:e}}r.default,t.CSVLink=o.default},58333:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.PropsNotForwarded=t.defaultProps=t.propTypes=void 0;var r,o=n(72791),a=((r=o)&&r.__esModule,n(52007));t.propTypes={data:(0,a.oneOfType)([a.string,a.array,a.func]).isRequired,headers:a.array,target:a.string,separator:a.string,filename:a.string,uFEFF:a.bool,onClick:a.func,asyncOnClick:a.bool,enclosingCharacter:a.string},t.defaultProps={separator:",",filename:"generatedBy_react-csv.csv",uFEFF:!0,asyncOnClick:!1,enclosingCharacter:'"'},t.PropsNotForwarded=["data","headers"]}}]);
//# sourceMappingURL=639.ea8a8b19.chunk.js.map